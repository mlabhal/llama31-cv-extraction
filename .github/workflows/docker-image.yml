name: Build and Push Docker Image

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      
      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v2
      
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{ secrets.DOCKER_USERNAME }}
          password: ${{ secrets.DOCKER_PASSWORD }}
      
      - name: Build and push
        uses: docker/build-push-action@v4
        with:
          context: .
          push: true
          tags: labhalmehdi/llama31-cv-extraction:latest
          build-args: |
            HF_TOKEN=${{ secrets.HF_TOKEN }}
```

4. Cliquez **"Commit changes"** ‚Üí **"Commit changes"**

---

### √âtape 4 : Ajouter les Secrets

1. Dans votre repo, allez dans **"Settings"** (en haut)
2. Dans le menu de gauche : **"Secrets and variables"** ‚Üí **"Actions"**
3. Cliquez **"New repository secret"**

**Ajoutez 3 secrets :**

**Secret 1 :**
- Name: `DOCKER_USERNAME`
- Value: `labhalmehdi`
- Cliquez **"Add secret"**

**Secret 2 :**
- Name: `DOCKER_PASSWORD`
- Value: (votre mot de passe Docker Hub)
- Cliquez **"Add secret"**

**Secret 3 :**
- Name: `HF_TOKEN`
- Value: `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`
- Cliquez **"Add secret"**

---

### √âtape 5 : Lancer le Build

1. Allez dans l'onglet **"Actions"** (en haut)
2. Cliquez sur **"Build and Push Docker Image"** (dans la liste de gauche)
3. Cliquez sur **"Run workflow"** ‚Üí **"Run workflow"**

üéâ **Le build d√©marre automatiquement !**

‚è±Ô∏è **Dur√©e : 20-30 minutes**

---

### √âtape 6 : Suivre la Progression

1. Dans **"Actions"**, cliquez sur le workflow en cours
2. Cliquez sur **"build"**
3. Vous verrez les √©tapes en temps r√©el :
```
   ‚úÖ Checkout code
   ‚úÖ Set up Docker Buildx
   ‚úÖ Login to Docker Hub
   üîÑ Build and push (en cours...)
```

---

### √âtape 7 : V√©rifier le R√©sultat

Une fois termin√© (‚úÖ en vert) :

1. Allez sur https://hub.docker.com/r/labhalmehdi/llama31-cv-extraction
2. Vous devriez voir votre image avec le tag **"latest"** !

---

## üéâ Succ√®s !

Votre image Docker sera disponible √† :
```
labhalmehdi/llama31-cv-extraction:latest
